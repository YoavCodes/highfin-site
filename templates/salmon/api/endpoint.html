<h1>API Endpoint</h1>
<p>The tail server exposes an endpoint at <code>http://domain.com/0</code>, although that's likely to change to something more readable in the future like <code>/_api_</code>.</p>

<p>The endpoint is the primary way your front-end talks to your back-end.</p>

<p>Every time the front-end navigates to a page, it hits the endpoint requesting any data or templates not already on the front-end for that page.</p>

<p>These post requests look like this:</p>
<pre class="prettyprint">
<code>[[  print( fin.fn.escapeHtml(`
pathname:
hashbang: salmon/api/endpoint
command:
template_list: example_template
`) )
]]</code>
</pre>
<p><code>pathname</code> is the part of the url path before the hashbang. Salmon is an incredibly flexible framework, if you had a simple website with a separate blog you could have the main site and blog be part of the same one-page app with a url structure like <code>/#!/</code> and <code>/#!/blog/posts</code> and a single index.html file with main and a blog pages defined in the <a class="type" href="/#!/salmon/api/init">configuration</a> object.</p>
<p>Or you could define two index.html files, and thus two one-page apps, each with their own pages defined, there would be a refresh when navigating between them and all the <code>fin</code> state would be cleared and effectively separated, including your data model and prefetched templates and so on. With that url structure you'd have <code>/#!/</code> and <code>/blog/#!/posts</code>.</p>
<p>In the first example the pathname is always blank, in the second example the pathname for the blog would be <code>blog</code>, either way fin will automatically extract it and send it along with requests to the endpoint.</p>

<p><code>hashbang</code> is the part of the url path after the <code>/#!/</code></p>

<p>pathname, hashbang, and command are used for routing on the tail server. A hashbang like <code>/#!/blog/posts</code> would likely be routed to a server-side function that fetches your blog posts. How you choose to use the three parameters to structure your routing hierarchy and back-end logic is up to you. While pathname and hashbang are automatically captured in most cases by fin, there are some cases &mdash; especially with forms, where you can use the <code>command</code> parameter to specify additional routing information.</p>

<p><code>template_list</code> is determined based on the pages defined in your <a class="type" href="/#!/salmon/api/init">configuration</a> object and populated automatically depending on which page you're navigating to and which of the required pages don't already exist on the client. </p>

<p>A typical response might look like this:</p>



<pre class="prettyprint">
<code>[[  print( fin.fn.escapeHtml(`
{
 "meta":
	{
	"status":200,
	"errors":[]
	},
 "data":{},
 "templates":
	{
	"example_template-html":"\"This is an example template!\""
	}
}
`) )
]]</code>
</pre>

<p>The <code>meta</code> block's status property allows us to differentiate between http status codes generated at various layers of the routing infrastructure, and status codes generated by your app logic. Setting it to a 301 for example while the entire response object has a status code of 200 allows us to handle the redirect within the app, without tripping up the browser, providing a degree of freedom and information that would otherwise be lacking.</p>

<p><code>errors</code> is simply an array of string error messages. You can add custom hooks on the front-end to display error messages as you like and use built-in methods to populate the array on the server (discussed elsewhere).</p>

<p>The <code>data</code> object maps directly to fin's data model and is automatically used to extend <code>fin.data</code>.</p>

<p>The <code>templates</code> object contains any requested templates <code>JSON.stringified</code>. The fin front-end will automatically request templates as needed from the server and it will automatically compile any templates received by the server. The only time you need to get involved is defining which pages use which templates in the <a class="type" href="/#!/salmon/api/init">configuration</a> object.</p>
<p></p>
<p></p>